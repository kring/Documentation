<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Working with TerriaJS and Cesium - TerriaJS</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Working with TerriaJS and Cesium";
    var mkdocs_page_input_path = "Contributors\\Contributing-to-TerriaJS.md";
    var mkdocs_page_url = "/Contributors/Contributing-to-TerriaJS/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> TerriaJS</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../..">Home</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../../GettingStarted/">Getting Started</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Catalog Management</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../CatalogManagement/">Overview</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../CatalogManagement/CKAN/">CKAN</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../CatalogManagement/GeoJSON/">GeoJSON</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../CatalogManagement/Web-Map-Service/">Web Map Service (WMS)</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../CatalogManagement/Performance-testing/">Performance Testing</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../CatalogManagement/Handling-CORS/">Issues with CORS</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../CatalogManagement/Initialization-File/">Initialization File</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../CatalogManagement/Format-Conversion-Service/">Format Conversion Service</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Customizing</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Customizing/">Overview</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Customizing/Config-JSON/">Config JSON</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Customizing/How-to-skin-a-Terria-Map/">Skinning</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Customizing/TerriaJS-URL-parameters/">URL Parameters</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Customizing/TerriaJS-in-iframe/">Controlling in an iframe</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Customizing/Extending-TerriaJS/">Extending TerriaJS</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Customizing/CKAN-previewer/">CKAN Previewer</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Customizing/WPS-parameters-guide/">WPS Parameters</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Deployment</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Deployment/">Overview</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Deployment/Deploying-Terria-Map/">Deploying TerriaMap</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Deployment/Deploying-and-building-TerriaJS/">Deploying and Building</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Deployment/Overall-system-architecture/">Overall System Architecture</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Deployment/Problems-and-Solutions/">Problems and Solutions</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Deployment/Setting-up-a-region-mapping-server/">Setting up a Region Mapping Server</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Deployment/Using-a-vector-tile-source-for-region-mapping/">Using a Vector Tile Source</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Deployment/WMS-Services/">WMS Services</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Contributors</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../">Overview</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Development-environment/">Development Environment</a>
        
    </li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">Working with TerriaJS and Cesium</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#working-on-terriajs-and-cesium">Working on TerriaJS and Cesium</a></li>
                
            
                <li class="toctree-l3"><a href="#committing-modifications">Committing modifications</a></li>
                
            
            </ul>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Setting-up-Saucelabs-Locally/">Setting up Saucelabs</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Using-Docker/">Using Docker</a>
        
    </li>

        
    </ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">TerriaJS</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Contributors &raquo;</li>
        
      
    
    <li>Working with TerriaJS and Cesium</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h2 id="working-on-terriajs-and-cesium">Working on TerriaJS and Cesium</h2>
<p>What if you need to make changes to <a href="https://github.com/AnalyticalGraphicsInc/cesium">Cesium</a> while working on TerriaJS?</p>
<p>In the deployment process, the <a href="https://www.npmjs.com/package/terriajs-cesium">terriajs-cesium package</a> is installed to the <code>node_modules</code> directory by <code>npm install</code>.  Please do not edit Cesium directly in the <code>node_modules</code> directory, because changes will be clobbered the next time you run <code>npm install</code>.  Instead, follow these instructions.</p>
<p>First, set up a Cesium dev environment on your system by following the <a href="https://github.com/AnalyticalGraphicsInc/cesium/wiki/Contributor%27s-Guide">instructions</a>.  Consider checking out TerriaJS/cesium instead of the official Cesium repository on GitHub.  Then, checkout an appropriate version of Cesium.  To use the exact version that Cesium is expecting (assuming you're working in the TerriaJS fork), do:</p>
<pre><code class="bash">cd terriajs
grep terriajs-cesium package.json
# will print something like: &quot;terriajs-cesium&quot;: &quot;0.0.6&quot;
cd ../Cesium
git checkout 0.0.6 # version from above

# Create a new branch to hold your changes.
git checkout -b someBranchName
</code></pre>

<p>If you're planning to upgrade TerriaJS's version of Cesium, you may choose to use the <code>terriajs</code> branch and merge in master from the official Cesium repository, instead of the precise version listed in <code>package.json</code>.</p>
<p>If using the <code>terriajs</code> branch, use gulp task <code>terria-default</code> in order to build Cesium's assets for TerriaJS.</p>
<p>Next, link your local version of Cesium into the global npm package repository:</p>
<pre><code>cd cesium
npm link
</code></pre>

<p>Then, link the now global <code>terriajs-cesium</code> package into National Map:</p>
<pre><code>cd terriajs
npm link terriajs-cesium
</code></pre>

<p>This process essentially makes National Map's <code>node_modules/terriajs-cesium</code> into a symlink to your <code>cesium</code> directory cloned from git.  Any changes you make to Cesium will be automatically picked up by TerriaJS.  Don't forget to run <code>npm install</code> in Cesium after pulling new changes or modifying <code>package.json</code>.  You will also need to build Cesium (by running <code>gulp</code>) if you modify any Cesium shaders or make changes to Cesium code that could affect Cesium's WebWorkers.</p>
<p>To switch TerriaJS back to using the npm version of Cesium, do:</p>
<pre><code>npm unlink terriajs-cesium
npm install
</code></pre>

<h2 id="committing-modifications">Committing modifications</h2>
<p>If you make changes to Cesium and TerriaJS together, here's the process for getting them to production.</p>
<p>First, commit your Cesium changes to a branch and open a pull request to merge that branch to master in the official Cesium repo. Simultaneously, you may want to make a branch of TerriaJS that uses your modified version of Cesium.  To do that, modify TerriaJS's <code>package.json</code>.  Where it has a line like:</p>
<pre><code>&quot;terriajs-cesium&quot;: &quot;^0.0.6&quot;,
</code></pre>

<p>Change it to:</p>
<pre><code>&quot;terriajs-cesium&quot;: &quot;git://github.com/TerriaJS/cesium.git#branchName&quot;,
</code></pre>

<p>Replace <code>branchName</code> with the name of the Cesium branch you want to use.  You may even use a repository other than <code>TerriaJS/cesium</code> if your branch is in a fork of Cesium instead of in the official repository.</p>
<p>Once your Cesium pull request has been merged and a new version of the <code>terriajs-cesium</code> npm module has been published, please remember to update <code>package.json</code> to point to an official <code>terriajs-cesium</code> version instead of a branch in a GitHub repo.</p>
<p>When at all possible, the <code>package.json</code> in the <code>master</code> branch should point to official releases of <code>terriajs-cesium</code> on npm, NOT GitHub branches.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../Setting-up-Saucelabs-Locally/" class="btn btn-neutral float-right" title="Setting up Saucelabs">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../Development-environment/" class="btn btn-neutral" title="Development Environment"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>
    
  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../Development-environment/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../Setting-up-Saucelabs-Locally/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script src="../../js/theme.js"></script>

</body>
</html>
